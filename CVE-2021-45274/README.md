# CVE-2021-45274 COTX-X3 Command Injection

## Description

OS Command Injection [CWE-78](https://cwe.mitre.org/data/definitions/78.html) in the websocket server in COTX Networks' COTX-X3 Hotspot Miner up to 1.1.14 allows attackers to execute arbitrary commands with root privileges by connecting without authentication to a vulnerable websocket endpoint.

## Firmware version details

+ 1.1.14 & earlier: vulnerable
+ 1.1.15: not released
+ 1.1.16: hotfix applied

## Details

At the Network Utilities section of the dashboard, users can debug connection issues by issuing ping and traceroute commands from the device. The value of the input field, where IP addresses can be submitted, is properly checked, but only on the frontend. Once any of the buttons is pressed, the commands `ping -c 4 <ip-address>` or `traceroute <ip-address>` are sent via websocket. The websocket server on the other hand performs no input checking, thus accepts and executes anything it receives. Using a simple websocket client, one can execute arbitrary commands on the device with root privileges without authentication.

1.1.16 contains input validation and the websocket endpoint accepts only the `ping -c 4 <ip-address>` and `traceroute <ip-address>` but still does not authenticate.

The next released version was 1.1.21, which I could not inspect.


## Disclaimer

This project can only be used for educational purposes. Using this software against target systems without prior permission is illegal, and any damages from misuse of this software will not be the responsibility of the author.

